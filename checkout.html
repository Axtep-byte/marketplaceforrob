<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button>

<header class="nav">
    <div class="logo">
        <img src="profile-icon.png" alt="–ü—Ä–æ—Ñ–∏–ª—å" id="profile-icon" style="width:30px; cursor:pointer;">
        MARKET
    </div>
    <nav>
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a href="cart.html">–ö–æ—Ä–∑–∏–Ω–∞</a>
    </nav>
</header>

<h1 class="page-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>

<form class="checkout-form fade-in">
    <label>–ò–º—è</label>
    <input type="text" required>

    <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
    <input type="tel" required>

    <label>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
    <input type="text" required>

    <button type="submit" class="btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
</form>

<script src="script.js"></script>
<script>
applyTheme();
document.querySelector(".checkout-form").onsubmit = e => {
    e.preventDefault();
    let cart = JSON.parse(localStorage.getItem("cart") || "{}");
    let total = 0;
    let products = JSON.parse(localStorage.getItem("products") || "[]");

    Object.keys(cart).forEach(id => {
        const p = products.find(x => x.id == id);
        total += p.price * cart[id];
    });

    let balance = parseInt(localStorage.getItem("balance") || 1000);

    if (balance < total) {
        alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!");
        return;
    }

    balance -= total;
    localStorage.setItem("balance", balance);
    localStorage.removeItem("cart");

    alert("–í–∞—à –∑–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ë–∞–ª–∞–Ω—Å: " + balance + " –≥—Ä–Ω");
    location.href = "index.html";
};
</script>

</body>
</html>
